#!/usr/bin/env bash

set -eu -o pipefail

TILES=

while (("$#")); do
  case "$1" in
    -h | --help)
      echo "usage: score <string>"
      echo "Calculate the Scrabble score for a word"
      exit 0
      ;;

    -H | --short-help)
      echo "Calculate the Scrabble score for a word"
      exit 0
      ;;

    *)
      if [ -n "$TILES" ]; then
        echo "unexpected argument: $1" >&2
        exit 1
      fi

      TILES="$1"
      shift
      ;;
  esac
done

if [ -z "$TILES" ]; then
  echo "usage: $0 <string>" >&2
  exit 1
fi

declare -i score=0

# Validate input
if [[ ! "$TILES" =~ ^[a-zA-Z]+$ ]]; then
  echo "input must contain only letters a-zA-Z" >&2
  exit 1
fi

# Calculate score
for ((i = 0; i < ${#TILES}; i++)); do
  case "${TILES:$i:1}" in
    A | E | I | O | U | L | N | S | T | R)
      score+=1
      ;;

    D | G)
      score+=2
      ;;

    B | C | M | P)
      score+=3
      ;;

    F | H | V | W | Y)
      score+=4
      ;;

    K)
      score+=5
      ;;

    J | X)
      score+=8
      ;;

    Q | Z)
      score+=10
      ;;

    # wildcard, score 0
    [a-z])
      score+=0
      ;;

    # This case should never be reached due to the earlier validation
    *)
      echo "unexpected character: ${TILES:$i:1}" >&2
      exit 1
      ;;
  esac
done

echo "$score"
